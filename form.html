<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Create Work Order</title>
</head>
<body>

<h2>Create Work Order</h2>

<label>Asset ID</label><br>
<input id="asset_id" value="TEST-ASSET"><br><br>

<label>Line</label><br>
<select id="line">
  <option>Line 1</option>
  <option>Line 2</option>
</select><br><br>

<label>Problem</label><br>
<textarea id="problem">Test problem</textarea><br><br>

<label>Priority</label><br>
<select id="priority">
  <option>Low</option>
  <option>Medium</option>
  <option selected>Critical</option>
</select><br><br>

<label>Owner</label><br>
<input id="owner" value="Tester"><br><br>

<button onclick="submitWO()">Submit Work Order</button>

<script>
async function submitWO() {

  const payload = {
    asset_id: document.getElementById("asset_id").value,
    line: document.getElementById("line").value,
    problem: document.getElementById("problem").value,
    priority: document.getElementById("priority").value,
    owner: document.getElementById("owner").value
  };

  const API_URL =
    "https://script.google.com/macros/s/AKfycbyMM20DT2UI1MH2BE3dsim7t94Ce6PsVM4R3CwsGCsjwE2s7BrRAZjZUa-v14hl_N9BJw/exec";

  const res = await fetch(API_URL, {
    method: "POST",
    body: JSON.stringify(payload)
  });

  const result = await res.json();

  if (result.status === "success") {
    alert("✅ Work Order Created : " + result.wo_id);
  } else {
    alert("❌ Error : " + result.message);
  }
}
</script>

</body>
</html>
