<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Technician - Work Order</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
  body {
    font-family: Arial, sans-serif;
    background: #f5f7fb;
    margin: 0;
    padding: 20px;
  }
  h1 {
    margin-bottom: 16px;
  }

  .filter-box {
    background: #fff;
    padding: 12px;
    border-radius: 10px;
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    margin-bottom: 16px;
  }

  .filter-box input,
  .filter-box select {
    padding: 8px;
    font-size: 14px;
    min-width: 140px;
  }

  .btn {
    padding: 8px 14px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
  }

  .btn.active {
    background: #1f3c88;
    color: #fff;
  }

  .btn.gray {
    background: #e0e0e0;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    background: #fff;
    border-radius: 10px;
    overflow: hidden;
  }

  th {
    background: #1f3c88;
    color: #fff;
    padding: 10px;
    text-align: left;
  }

  td {
    padding: 10px;
    border-bottom: 1px solid #eee;
  }
</style>
</head>

<body>

<h1>ðŸ›  Technician â€“ Work Order</h1>

<!-- FILTER -->
<div class="filter-box">
  <input id="fWo" placeholder="WO ID" oninput="applyFilter()" />
  <input id="fAsset" placeholder="Asset" oninput="applyFilter()" />
  <input id="fProblem" placeholder="Problem" oninput="applyFilter()" />

  <select id="fPriority" onchange="applyFilter()">
    <option value="">All Priority</option>
    <option>Critical</option>
    <option>High</option>
    <option>Medium</option>
    <option>Low</option>
  </select>

  <button class="btn active" onclick="setStatus('')">ALL JOBS</button>
  <button class="btn gray" onclick="setStatus('OPEN')">OPEN</button>
  <button class="btn gray" onclick="setStatus('IN PROGRESS')">IN PROGRESS</button>
  <button class="btn gray" onclick="setStatus('DONE')">DONE</button>
</div>

<!-- TABLE -->
<table>
  <thead>
    <tr>
      <th>WO ID</th>
      <th>Asset</th>
      <th>Problem</th>
      <th>Priority</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody id="jobTable"></tbody>
</table>

<script>
const GAS_URL = "PUT_YOUR_WEBAPP_URL_HERE"; 
// â¬†ï¸ à¹ƒà¸Šà¹‰ URL à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸šà¸—à¸µà¹ˆà¸„à¸¸à¸“à¹ƒà¸Šà¹‰à¹‚à¸«à¸¥à¸” technician à¸à¹ˆà¸­à¸™à¸«à¸™à¹‰à¸²

let allJobs = [];
let currentStatus = "";

// ================================
// LOAD ALL JOBS
// ================================
fetch(GAS_URL + "?mode=alljobs")
  .then(res => res.json())
  .then(data => {
    allJobs = data;
    applyFilter();
  });

// ================================
// FILTER LOGIC
// ================================
function setStatus(status) {
  currentStatus = status;

  document.querySelectorAll(".btn").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");

  applyFilter();
}

function applyFilter() {
  const wo = document.getElementById("fWo").value.toLowerCase();
  const asset = document.getElementById("fAsset").value.toLowerCase();
  const problem = document.getElementById("fProblem").value.toLowerCase();
  const priority = document.getElementById("fPriority").value;

  const filtered = allJobs.filter(j =>
    (!wo || j.wo_id.toLowerCase().includes(wo)) &&
    (!asset || j.asset.toLowerCase().includes(asset)) &&
    (!problem || j.problem.toLowerCase().includes(problem)) &&
    (!priority || j.priority === priority) &&
    (!currentStatus || j.status === currentStatus)
  );

  renderTable(filtered);
}

// ================================
// RENDER TABLE
// ================================
function renderTable(rows) {
  const tbody = document.getElementById("jobTable");
  tbody.innerHTML = "";

  rows.forEach(r => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${r.wo_id}</td>
      <td>${r.asset}</td>
      <td>${r.problem}</td>
      <td>${r.priority}</td>
      <td>${r.status}</td>
    `;
    tbody.appendChild(tr);
  });
}
</script>

</body>
</html>
